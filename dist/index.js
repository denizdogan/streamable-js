'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.AuthStreamable=exports.Streamable=undefined;var _get2=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else {return get(parent,property,receiver)}}else if('value' in desc){return desc.value}else {var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value' in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _fs=require('fs');var _fs2=_interopRequireDefault(_fs);var _requestPromise=require('request-promise');var _requestPromise2=_interopRequireDefault(_requestPromise);var _urlJoin=require('url-join');var _urlJoin2=_interopRequireDefault(_urlJoin);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called')}return call&&(typeof call==='object'||typeof call==='function')?call:self}function _inherits(subClass,superClass){if(typeof superClass!=='function'&&superClass!==null){throw new TypeError('Super expression must either be null or a function, not '+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var API_BASE_URL='https://api.streamable.com';var Streamable=exports.Streamable=function(){function Streamable(){_classCallCheck(this,Streamable)}_createClass(Streamable,[{key:'uploadStream',value:function uploadStream(stream){var title=arguments.length<=1||arguments[1]===undefined?'':arguments[1];var data={file:stream,title:title};return this._post('/upload',data)}},{key:'uploadVideo',value:function uploadVideo(filePath){var title=arguments.length<=1||arguments[1]===undefined?'':arguments[1];var stream=_fs2.default.createReadStream(filePath);return this.uploadStream(stream,title)}},{key:'importVideo',value:function importVideo(url){var title=arguments.length<=1||arguments[1]===undefined?'':arguments[1];var qs={url:url,title:title};return this._get('/import',qs)}},{key:'retrieveVideo',value:function retrieveVideo(shortcode){return this._get('/videos/'+shortcode)}},{key:'retrieveUser',value:function retrieveUser(username){return this._get('/users/'+username)}},{key:'_request',value:function _request(method,path){var options=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];var url=(0,_urlJoin2.default)(API_BASE_URL,path);options=this._prepareOptions(method,path,options);return (0,_requestPromise2.default)(url,options)}},{key:'_get',value:function _get(path){var qs=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];return this._request('GET',path,{qs:qs})}},{key:'_post',value:function _post(path){var data=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];return this._request('POST',path,{formData:data})}},{key:'_prepareOptions',value:function _prepareOptions(method,path){var options=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];return Object.assign({},options,{method:method,json:true})}}]);return Streamable}();var AuthStreamable=exports.AuthStreamable=function(_Streamable){_inherits(AuthStreamable,_Streamable);function AuthStreamable(username,password){_classCallCheck(this,AuthStreamable);var _this=_possibleConstructorReturn(this,Object.getPrototypeOf(AuthStreamable).call(this));_this.username=username;_this.password=password;return _this}_createClass(AuthStreamable,[{key:'retrieveMe',value:function retrieveMe(){return this._get('/me')}},{key:'_prepareOptions',value:function _prepareOptions(method,path){var options=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];options=_get2(Object.getPrototypeOf(AuthStreamable.prototype),'_prepareOptions',this).call(this,method,path,options);return Object.assign({},options,{auth:{username:this.username,password:this.password}})}}]);return AuthStreamable}(Streamable);